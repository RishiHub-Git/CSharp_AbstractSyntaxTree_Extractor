{
  "Namespaces": [
    {
      "Name": "Default NameSpace",
      "Classes": [
        {
          "Name": "PerformanceBehaviour",
          "Access_Modifier": "public",
          "Is_Class_Static": false,
          "XMLComment": "",
          "Comment": "",
          "Methods": [
            {
              "XMLComment": "",
              "Comment": "",
              "Name": "Handle",
              "Access_Modifier": "public",
              "Is_Method_Static": false,
              "Parameters": "TRequest request, RequestHandlerDelegate<TResponse> next, CancellationToken cancellationToken",
              "ReturnType": "Task<TResponse>",
              "Body": "{\n        _timer.Start();\n\n        var response = await next();\n\n        _timer.Stop();\n\n        var elapsedMilliseconds = _timer.ElapsedMilliseconds;\n\n        if (elapsedMilliseconds > 500)\n        {\n            var requestName = typeof(TRequest).Name;\n            var userId = _user.Id ?? string.Empty;\n            var userName = string.Empty;\n\n            if (!string.IsNullOrEmpty(userId))\n            {\n                userName = await _identityService.GetUserNameAsync(userId);\n            }\n\n            _logger.LogWarning(\"CleanArchitecture Long Running Request: {Name} ({ElapsedMilliseconds} milliseconds) {@UserId} {@UserName} {@Request}\",\n                requestName, elapsedMilliseconds, userId, userName, request);\n        }\n\n        return response;\n    }"
            }
          ],
          "Constructors": [
            {
              "Name": "PerformanceBehaviour",
              "Access_Modifier": "public",
              "Body": "{\n        _timer = new Stopwatch();\n\n        _logger = logger;\n        _user = user;\n        _identityService = identityService;\n    }",
              "Parameters": "ILogger<TRequest> logger, IUser user, IIdentityService identityService"
            }
          ],
          "Fields": [
            {
              "Name": "_timer",
              "FieldType": "Stopwatch",
              "Access_Modifier": "private",
              "IsReadonly": true
            },
            {
              "Name": "_logger",
              "FieldType": "ILogger<TRequest>",
              "Access_Modifier": "private",
              "IsReadonly": true
            },
            {
              "Name": "_user",
              "FieldType": "IUser",
              "Access_Modifier": "private",
              "IsReadonly": true
            },
            {
              "Name": "_identityService",
              "FieldType": "IIdentityService",
              "Access_Modifier": "private",
              "IsReadonly": true
            }
          ],
          "Properties": []
        }
      ]
    }
  ]
}